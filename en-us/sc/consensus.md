---
name: Consensus

---

## 1 - List of Terms


* Proof of Stake (PoS) - A schema which uses network consensus to handle fault tolerance.
* Proof of Work (PoW) - A schema which uses compute utility to handle fault tolerance.
* Byzantine Fault (BF) - A failure in which a node continues to operate in a non-honest manner.
* Practical Byzantine Fault Tolerance (PBFT) - A cosensus algorithm implemented within the AntShares block chain to garantee fault tolerance.
* View - The data set used during consensus in AntShares PBFT

## 2 - Introduction

## 3 - Background
One of the fundamental differences between blockchains how they can garantee fault tolerance due to either defects or malicious intent.
Traditional methods implemented using PoW can provide this garantee as long as a majority of the networks computational power is honest.
Because of this schema's dependency on compute, the mechanism can be very resource intensive (computational power costs energy and requires hardware).
These dependencies expose a PoW network to a number of limitations, specifically the barrier ...

AntShares implements a proof of work schema using Practical Byzantine Fault Tolerance which protects the network from Byzantine faults using minimal resources.

 
## 4 - Theory
synchronicity



## 5 - Practical Implementation
In AntShares, there are two primary network roles:
Consensus Node - This node participates in the consensus activity
Bookkeeper Node - bookkeeper nodes act as a scribe and digitally sign the blocks that are generated by consensus nodes

In the AntShares consensus algorithm, there are two roles that the Consensus Nodes take:
1. Speaker (1) - The speaker is analogous to the general in section 4.  They are responsible for transmitting a block proposal to the system.
2. Congressman (Many) - Congressman nodes are analogous to the leutenant in section 4.  They are responsible reaching a consensus on the transaction

In the blockchain, we have four primary requirements for consensus fault tolerance using PBFT:

1. s congressment must reach a consensus about a transaction before a block can be committed.
2. Dishonest consensus nodes must not be able to persuade the honest consensus nodes of faulty transactions.  	
3. s accountants must reach consensus about the block produced by the consensus activity	
4. If the generated block is honest, all honest bookkeepers are in agreement with the honest congressmen.
	
var t = block generation time interval
var s = the 'safe' consensus node population (n -f)
var h = block height
var v = the view
var k = the index of the view 
var i = consensus node index
var p = index of the node elected as the speaker

var speaker = a node elected to initiate the consensus activity
var congressment = a node that is not the congressment (votes in the consensus)


Requirements:
at least s nodes are in same state (same h and k)


1) a consensus node broadcasts a transaction to entire network with sender's signatures
2) bookkeeper nodes log transaction data into local memory

3) elect consensus nodes(?)
2) initialize view
	identify speaker of the house (blockHeight - viewID) mod (number of consensus nodes)
	after t: 
		speaker sends proposal<prepareRequest, h, k, p, bloc, [block]sigp>
	congressmen receive proposal
		validate transactions:
			is data format consistant with system rules?
			is transaction already on blockchain?
			are contract scripts correctly executed?
			does the transaction only contain a single spend?
			
		if validated proposal: respond:  <prepareResponse, h, k, i, [block]sigi>
		if illegal proposal: increment view
		
	after receiving s responses, a node reaches a consensus and publishes a block
	when a node receives a full block, delete currently held transaction data, begin new concensus round
	
generate new block and bookkeepers sign (requires s signatures)
reset(v = 0)
 
 
 
 after 2^(v+1) * t, if not consensus:
	node(i) sends <ChangeView, h,k,i,k+1>
	one a node receives at least s identical changeview (k) signals, it increments the view and consensus begins
	
	
 
 
 
 
Question:
How is spoofing prevented?	

synchronicity
	

	
## Example

## References
1. [original_Byzantine](http://www-inst.eecs.berkeley.edu/~cs162/fa12/hand-outs/Original_Byzantine.pdf)
2. [PBFT](https://kelehers.me/others/pbftByzantine.pdf)
3. [A Byzantine Faul Tolerance Algorithm for Blockchain](https://www.antshares.org/Files/A8A0E2.pdf)
